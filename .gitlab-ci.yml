image: gcc    

linting:
  stage: test
  before_script:
    - apt-get update
    - apt-get -y install cmake autoconf
    - apt-get -y install clang clang-tidy clang-format
  script:
    - cd Parser
    - clang-tidy *.cpp -- 
    - clang *.cpp -fsyntax-only -Werror

unit_testing:
  stage: test
  before_script:
    - apt-get update
    - apt-get -y install cmake autoconf
  script:
    - mkdir parser_build
    - cd parser_build
    - cmake ../Parser_Test
    - cmake --build .
    - ./parser_tests --gtest_output="xml:report.xml"
    
    
integration_testing:
  stage: test
  before_script:
    - apt-get update
    - apt-get -y install cmake autoconf
    - wget http://131.123.42.38/lmcrs/v1.0.0/srcml_1.0.0-1_ubuntu18.04.deb
    - apt-get -y install ./srcml_1.0.0-1_ubuntu18.04.deb
  script:
    - cd StandAlone
    - mkdir build
    - cd build
    - cmake ../
    - cmake --build .
    - ./parser_standalone ../../tools
    - cd ../../Parser_Test/Integration
    - cmake .
    - cmake --build .
    - ./parser_tests_integration --gtest_output="xml:report.xml"


